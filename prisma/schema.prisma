generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Product {
  id             String                 @id @default(auto()) @map("_id") @db.ObjectId
  slug           String                 @unique
  title          String
  mainImage      String
  price          Int                    @default(0)
  rating         Int                    @default(0)
  discount       Int                    @default(0)
  description    String
  manufacturer   String
  deposit        Int                    @default(0)
  isOfferItem    Boolean                @default(false)
  isFeatured     Boolean                @default(false)
  isHotDeal      Boolean                @default(false)
  coverPhoto     String?
  brandId        String?                @db.ObjectId
  brand          Brand?                 @relation(fields: [brandId], references: [id])
  features       String[]
  availabilityStatus AvailabilityStatus @default(AVAILABLE)
  inStock        Int                    @default(1)
  categoryId     String                 @db.ObjectId
  category       Category               @relation(fields: [categoryId], references: [id])
  customerOrders customer_order_product[]
  Wishlist       Wishlist[]
  merchantId     String                 @db.ObjectId
  merchant       Merchant               @relation(fields: [merchantId], references: [id])
  bulkUploadItems bulk_upload_item[]    @relation("ProductBulkItems")
}

model Image {
  imageID   String @id @default(auto()) @map("_id") @db.ObjectId
  productID String @db.ObjectId
  image     String
}

model User {
  id             String                 @id @default(auto()) @map("_id") @db.ObjectId
  email          String                 @unique
  password       String?
  role           String?                @default("user")
  isActive       Boolean                @default(true)
  Wishlist       Wishlist[]
  notifications  Notification[]
  bulkUploadBatches bulk_upload_batch[] @relation("UserBatches")
}

model Customer_order {
  id                 String                 @id @default(auto()) @map("_id") @db.ObjectId
  name               String
  lastname           String
  phone              String
  email              String
  company            String
  adress             String
  apartment          String
  postalCode         String
  dateTime           DateTime?              @default(now())
  rentalStartDate    DateTime?
  rentalEndDate      DateTime?
  rentalDurationDays Int                    @default(1)
  fulfillmentMethod  String                 @default("delivery")
  status             OrderStatus
  paymentStatus      PaymentStatus          @default(UNPAID)
  city               String
  country            String
  orderNotice        String?
  rentalTotal        Int                    @default(0)
  depositTotal       Int                    @default(0)
  grandTotal         Int                    @default(0)
  total              Int
  products           customer_order_product[]
}

model customer_order_product {
  id              String         @id @default(auto()) @map("_id") @db.ObjectId
  customerOrder   Customer_order @relation(fields: [customerOrderId], references: [id])
  customerOrderId String         @db.ObjectId
  product         Product        @relation(fields: [productId], references: [id])
  productId       String         @db.ObjectId
  quantity        Int
  dailyPriceSnapshot Int         @default(0)
  depositSnapshot    Int         @default(0)
}

model Category {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  name     String    @unique
  products Product[]
}

model Brand {
  id       String    @id @default(auto()) @map("_id") @db.ObjectId
  name     String    @unique
  imageUrl String?
  products Product[]
}

model Wishlist {
  id        String  @id @default(auto()) @map("_id") @db.ObjectId
  product   Product @relation(fields: [productId], references: [id])
  productId String  @db.ObjectId
  user      User    @relation(fields: [userId], references: [id])
  userId    String  @db.ObjectId
}

enum NotificationType {
  ORDER_UPDATE
  PAYMENT_STATUS
  PROMOTION
  SYSTEM_ALERT
}

enum NotificationPriority {
  LOW
  NORMAL
  HIGH
  URGENT
}

model Notification {
  id        String               @id @default(auto()) @map("_id") @db.ObjectId
  userId    String               @db.ObjectId
  user      User                 @relation(fields: [userId], references: [id])
  title     String
  message   String
  type      NotificationType
  isRead    Boolean              @default(false)
  priority  NotificationPriority @default(NORMAL)
  metadata  Json?
  createdAt DateTime             @default(now())
  updatedAt DateTime             @updatedAt

  @@index([userId])
  @@index([userId, isRead])
  @@index([userId, type])
  @@index([createdAt])
}

model Merchant {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String?
  email       String?
  phone       String?
  address     String?
  image       String?
  status      String   @default("ACTIVE")
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  products    Product[]
}

model bulk_upload_batch {
  id         String           @id @default(auto()) @map("_id") @db.ObjectId
  fileName   String?
  createdAt  DateTime         @default(now())
  status     BulkUploadStatus @default(PENDING)
  itemCount  Int              @default(0)
  errorCount Int              @default(0)
  items      bulk_upload_item[]
  userId     String?          @db.ObjectId
  user       User?            @relation(name: "UserBatches", fields: [userId], references: [id])
}

model bulk_upload_item {
  id           String            @id @default(auto()) @map("_id") @db.ObjectId
  batchId      String            @db.ObjectId
  batch        bulk_upload_batch @relation(fields: [batchId], references: [id])
  productId    String?           @db.ObjectId
  product      Product?          @relation(name: "ProductBulkItems", fields: [productId], references: [id])
  title        String
  slug         String
  price        Int
  manufacturer String?
  description  String?
  mainImage    String?
  categoryId   String            @db.ObjectId
  inStock      Int
  status       BulkUploadItemStatus @default(CREATED)
  error        String?
}

enum BulkUploadStatus {
  PENDING
  COMPLETED
  PARTIAL
  FAILED
}

enum BulkUploadItemStatus {
  CREATED
  UPDATED
  ERROR
}

enum AvailabilityStatus {
  AVAILABLE
  UNDER_MAINTENANCE
  UNAVAILABLE
}

enum OrderStatus {
  PENDING
  CONFIRMED
  RENTED
  RETURNED
  COMPLETED
  CANCELED
}

enum PaymentStatus {
  UNPAID
  PAID
  REFUNDED
  PARTIAL
}

model SiteSettings {
  id                 String   @id @default(auto()) @map("_id") @db.ObjectId
  logoUrl            String?
  contactPhone       String?
  contactEmail       String?
  heroTitle          String?
  heroSubtitle       String?
  heroImageUrl       String?
  noticeBarText      String?
  noticeBarEnabled   Boolean  @default(false)
  noticeBarAnimationEnabled Boolean @default(true)
  showPopupEnabled   Boolean  @default(true)
  footerSale         Json?
  footerAbout        Json?
  footerBuy          Json?
  footerHelp         Json?
  asdCameraTitle     String?
  asdCameraDescription String?
  asdCameraLocations Json?
  socialLinks        Json?
  paymentMethods     Json?
  whatsappNumber     String?
  whatsappEnabled    Boolean  @default(false)
  messengerEnabled   Boolean  @default(false)
  messengerUsername  String?
  adminMessengerPsid String?
  updatedAt          DateTime @updatedAt
}

model SliderItem {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  title     String?
  subtitle  String?
  imageUrl  String
  ctaText   String?
  ctaHref   String?
  order     Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model ClientLogo {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  imageUrl  String?
  alt       String?
  href      String?
  order     Int      @default(0)
  active    Boolean  @default(true)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Banner {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  imageUrl  String
  title     String?
  href      String?
  position  String   @default("home")
  active    Boolean  @default(true)
  order     Int      @default(0)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Popup {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  name      String
  imageUrl  String
  enabled   Boolean  @default(true)
  isActive  Boolean  @default(false)
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}